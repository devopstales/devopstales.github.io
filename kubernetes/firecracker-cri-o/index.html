<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	
<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https://devopstales.github.io/"
    },
    "articleSection" : "kubernetes",
    "name" : "How to deploy CRI-O with Firecracker?",
    "image": "https://devopstales.github.io/img/firecracker.png",
    "headline" : "How to deploy CRI-O with Firecracker?",
    "description" : "In this post I will show you how you can install and use kata-container with Firecracker engine in kubernetes.\n",
    "inLanguage" : "en-US",
    "author" : "Blaiserman",
    "creator" : "Blaiserman",
    "publisher": "Blaiserman",
    "accountablePerson" : "Blaiserman",
    "copyrightHolder" : "Blaiserman",
    "copyrightYear" : "2021",
    "datePublished": "2021-08-23",
    "dateModified" : "2021-08-23",
    "url" : "https://devopstales.github.io/kubernetes/firecracker-cri-o/",
    "wordCount" : "1230",
    "keywords" : [ "Kubernetes", "kata-container", "Firecracker", "CRI-O", "qvemu", "kvm", "AlmaLinux", "devmapper", "devicemapper", "Blog" ]
    
}
</script>

<meta name="msvalidate.01" content="4E830BF9C048B3A327492699A61E741E" />
<meta name="yandex-verification" content="96d0b6ba6c7aa697" />

	<title>How to deploy CRI-O with Firecracker? - devopstales</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="How to deploy CRI-O with Firecracker?" />
<meta property="og:description" content="In this post I will show you how you can install and use kata-container with Firecracker engine in kubernetes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://devopstales.github.io/kubernetes/firecracker-cri-o/" /><meta property="article:section" content="kubernetes" />
<meta property="article:published_time" content="2021-08-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-08-23T00:00:00+00:00" />
<meta property="og:see_also" content="https://devopstales.github.io/kubernetes/k8s-ps/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/k8s-central-oauth/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/k8s-rbac-gen/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/k8s-falco/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/k8s-cisa-install/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/k8s-seccomp/" />
<meta property="og:see_also" content="https://devopstales.github.io/kubernetes/k8s-install-containerd/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/docker-desktop-alternatives/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/gvisor-cri-o/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/firecracker-containerd/" /><meta property="og:see_also" content="https://devopstales.github.io/kubernetes/gvisor-containerd/" />


	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="https://devopstales.github.io/css/style.css">
	<link rel="stylesheet" href="https://devopstales.github.io/css/coffeebox.css"><link rel="stylesheet" href="https://devopstales.github.io/css/cookie.css">
	<link rel="shortcut icon" href="https://devopstales.github.io/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-135626110-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

        <meta name="twitter:image" content="https://devopstales.github.io/img/firecracker.png">
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="https://devopstales.github.io/" title="devopstales" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">devopstales</div>
					<div class="logo__tagline">Blog about dev and ops stuff</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="https://devopstales.github.io/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://devopstales.github.io/linux/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">Linux</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://devopstales.github.io/kubernetes/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">Kubernetes</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://devopstales.github.io/sso/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">sso</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://devopstales.github.io/monitoring/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">monitoring</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://devopstales.github.io/cloud/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">cloud</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="https://devopstales.github.io/windows/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">Windows</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">How to deploy CRI-O with Firecracker?</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2021-08-23T00:00:00Z">August 23, 2021</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="https://devopstales.github.io/categories/kubernetes/" rel="category">Kubernetes</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>In this post I will show you how you can install and use kata-container with Firecracker engine in kubernetes.</p>
<H3>Parst of the K8S Security series</H3>
<ul>
     <li>Part1: <a href="../../kubernetes/k8s-security/">Best Practices to keeping Kubernetes Clusters Secure</a></li>
     <li>Part2: <a href="../../kubernetes/k8s-cisa-install">Kubernetes Hardening Guide with CIS 1.6 Benchmark</a></li>
     <li>Part3: <a href="../../kubernetes/rke2-airgap-install/">RKE2 The Secure Kubernetes Engine</a></li>
     <li>Part4: <a href="../../kubernetes/rke2-cilium/">RKE2 Install With cilium</a></li>
     <li>Part5: <a href="../../kubernetes/k8s-cert/">Kubernetes Certificate Rotation</a></li>
<!-- RBAC -->
     <li>Part6: <a href="../../kubernetes/k8s-secomp/">Hardening Kubernetes with seccomp</a></li>
     <li>Part7a: <a href="../../kubernetes/rke2-psp/">RKE2 Pod Security Policy</a></li>
     <li>Part7b: <a href="../../kubernetes/k8s-ps/">Kubernetes Pod Security</a></li>
<!-- # Policy -->
     <li>Part8: <a href="../../kubernetes/k8s-networkpolicy/">Kubernetes Network Policy</a></li>
     <li>Part9: <a href="../../kubernetes/kubernetes-policy/">Kubernetes Cluster Policy</a></li>
<!-- # Admission Controllers -->
     <li>Part10: <a href="../../kubernetes/admission-controllers/">Using Admission Controllers</a></li>
<!-- ## Image Scan -->
     <li>Part11a: <a href="../../kubernetes/image-security-admission-controller/">Image security Admission Controller</a></li>
     <li>Part11b: <a href="../../kubernetes/image-security-admission-controller-v2/">Image security Admission Controller V2</a></li>
     <li>Part11c: <a href="../../kubernetes/image-security-admission-controller-v3/">Image security Admission Controller V3</a></li>
<!-- https://github.com/banzaicloud/dast-operator -->
<!-- # Scans & Monitoring -->
     <li>Part12: <a href="../../kubernetes/continuous-image-security/">Continuous Image security</a></li>
     <li>Part13: <a href="../../kubernetes/k8s-prometheus-stack/">K8S Logging And Monitoring</a></li>
     <li>Part14: <a href="../../kubernetes/k8s-falco/">Kubernetes audit logs and Falco</a></li>
<!-- kyverno logs and monitoring -->
<!-- DAST Exporter?? -->
<!-- CIS Exporter https://github.com/ibrokethecloud/kube-bench-metrics -->
<!-- # Image Signature Verification -->
     <li>Part15a <a href="../../kubernetes/k8s-connaisseur/">Image Signature Verification with Connaisseur</a></li>
     <li>Part15b <a href="../../kubernetes/k8s-connaisseur-v2/">Image Signature Verification with Connaisseur 2.0</a></li>
     <li>Part15c <a href="../../kubernetes/k8s-kyverno-cosign/">Image Signature Verification with Kyverno</a></li>
<!-- # Backup -->
     <li>Part16a <a href="../../kubernetes/k8s-backup/">Backup your Kubernetes Cluster</a></li>
     <li>Part16b <a href="../../kubernetes/k8s-git-backup/">How to Backup Kubernetes to git?</a></li>
<!-- # Secrets -->
     <li>Part17a <a href="../../kubernetes/k8s-vault/">Kubernetes and Vault integration</a></li>
     <li>Part17b <a href="../../kubernetes/k8s-vault-v2/">Kubernetes External Vault integration</a></li>
     <li>Part18a: <a href="../../kubernetes/argocd-kubeseal/">ArgoCD and kubeseal to encript secrets</a></li>
     <li>Part18b: <a href="../../kubernetes/gitops-flux2-kubeseal/">Flux2 and kubeseal to encrypt secrets</a></li>
     <li>Part18c: <a href="../../kubernetes/gitops-flux2-sops/">Flux2 and Mozilla SOPS to encrypt secrets</a></li>
<!-- # Image Update -->
<!-- keel -->
     <li>Part19: <a href="../../kubernetes/argocd-image-updater/">ArgoCD auto image updater</a></li>
<!-- flux image update -->
     <li>Part20: <a href="../../kubernetes/k3s-gvisor/">Secure k3s with gVisor</a></li>
<!-- # Image registry security -->
     <li>Part21: <a href="../../kubernetes/k8s-imagepullsecret-patcher/">How to use imagePullSecrets cluster-wide??</a></li>
     <li>Part22: <a href="../../kubernetes/kyverno-image-mirror/">Automatically change registry in pod definition</a></li>

<!-- sysdig falco -->
<!-- Image auto update:
https://keel.sh
https://blog.weareopensource.me/kell-automate-rancher-workloads-update/
flux
https://github.com/weaveworks/kured
-->
<!-- resource kvota -->
</ul>



<h3 id="what-is-kata-container-engine">What is Kata container engine</h3>
<p>Kata Containers is an open source community working to build a secure container runtime with lightweight virtual machines that feel and perform like containers, but provide stronger workload isolation using hardware virtualization technology as a second layer of defense. (Source: <a href="https://katacontainers.io/">Kata Containers Website</a> )</p>
<p><img src="https://devopstales.github.io/img/include/katacontainers.jpg" alt="Kata container engine"  class="zoomable" /></p>
<h3 id="why-should-you-use-firecracker">Why should you use Firecracker?</h3>
<p>Firecracker is a way to run virtual machines, but its primary goal is to be used as a container runtime interface, making it use very few resources by design.</p>
<h3 id="enable-qvemu">Enable qvemu</h3>
<p>I will use Vagrant and VirtualBox for running the AlmaLinux VM so first I need to enable then Nested virtualization on the VM:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">VBoxManage modifyvm alma8 --nested-hw-virt on
</code></pre></div><p>After the Linux is booted test the virtualization flag in the VM:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">egrep --color -i <span style="color:#e6db74">&#34;svm|vmx&#34;</span> /proc/cpuinfo
</code></pre></div><p>If you find one of this flags everything is ok. Now we need to enable the kvm kernel module.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo modprobe kvm-intel
sudo modprobe vhost_vsock
</code></pre></div><h3 id="disable-selinux">Disable selinux</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">setenforce <span style="color:#ae81ff">0</span>
sed -i <span style="color:#e6db74">&#39;s/=\(enforcing\|permissive\)/=disabled/g&#39;</span> /etc/sysconfig/selinux
sed -i <span style="color:#e6db74">&#39;s/=\(enforcing\|permissive\)/=disabled/g&#39;</span> /etc/selinux/config
</code></pre></div><h3 id="install-and-configure-cri-o">Install and configure CRI-O</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf install epel-release nano wget -y

export VERSION<span style="color:#f92672">=</span>1.21
sudo curl -L -o /etc/yum.repos.d/devel_kubic_libcontainers_stable.repo https://download.opensuse.org/repositories/devel:kubic:libcontainers:stable/CentOS_8/devel:kubic:libcontainers:stable.repo

sudo curl -L -o /etc/yum.repos.d/devel_kubic_libcontainers_stable_cri-o_<span style="color:#e6db74">${</span>VERSION<span style="color:#e6db74">}</span>.repo https://download.opensuse.org/repositories/devel:kubic:libcontainers:stable:cri-o:<span style="color:#e6db74">${</span>VERSION<span style="color:#e6db74">}</span>/CentOS_8/devel:kubic:libcontainers:stable:cri-o:<span style="color:#e6db74">${</span>VERSION<span style="color:#e6db74">}</span>.repo

yum install cri-o
</code></pre></div><p>Devmapper is the only storage driver supported by Firecracker. The stable pubic verion of <code>cri-o</code> dose not contained the support for devicemapper. Thanx to <code>Sascha Grunert</code> ther is a new version built with libdevmapper. He answered my question on slack immediately and created a patch for this bug.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nano /etc/containers/storage.conf
<span style="color:#f92672">[</span>storage<span style="color:#f92672">]</span>
driver <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devicemapper&#34;</span>
...
<span style="color:#f92672">[</span>storage.options.thinpool<span style="color:#f92672">]</span>
autoextend_percent <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;20&#34;</span>
autoextend_threshold <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;80&#34;</span>
basesize <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;8G&#34;</span>
directlvm_device <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/dev/sdb&#34;</span>
directlvm_device_force <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;True&#34;</span>
fs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xfs&#34;</span>

nano /etc/containers/registries.conf
registries <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
  <span style="color:#e6db74">&#34;quay.io&#34;</span>,
  <span style="color:#e6db74">&#34;docker.io&#34;</span>
<span style="color:#f92672">]</span>
unqualified-search-registries <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
  <span style="color:#e6db74">&#34;quay.io&#34;</span>,
  <span style="color:#e6db74">&#34;docker.io&#34;</span>
<span style="color:#f92672">]</span>

systemctl enable crio
systemctl restart crio
systemctl status crio

$ crio-status info
storage root: /var/lib/containers/storage
default GID mappings <span style="color:#f92672">(</span>format &lt;container&gt;:&lt;host&gt;:&lt;size&gt;<span style="color:#f92672">)</span>:
  0:0:4294967295
default UID mappings <span style="color:#f92672">(</span>format &lt;container&gt;:&lt;host&gt;:&lt;size&gt;<span style="color:#f92672">)</span>:
  0:0:4294967295
</code></pre></div><h3 id="install-tools">Install tools</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yum install git -y

sudo git clone https://github.com/ahmetb/kubectx /opt/kubectx
sudo ln -s /opt/kubectx/kubectx /usr/local/sbin/kubectx
sudo ln -s /opt/kubectx/kubens /usr/local/sbin/kubens
</code></pre></div><h3 id="install-kubernetes">Install Kubernetes</h3>
<p>Configure Kernel parameters for Kubernetes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">modprobe overlay
modprobe br_netfilter

cat <span style="color:#e6db74">&lt;&lt;EOF | sudo tee /etc/modules-load.d/containerd.conf
</span><span style="color:#e6db74">overlay
</span><span style="color:#e6db74">br_netfilter
</span><span style="color:#e6db74">kvm-intel
</span><span style="color:#e6db74">vhost_vsock
</span><span style="color:#e6db74">EOF</span>

cat <span style="color:#e6db74">&lt;&lt;EOF &gt;  /etc/sysctl.d/k8s.conf
</span><span style="color:#e6db74">net.bridge.bridge-nf-call-ip6tables = 1
</span><span style="color:#e6db74">net.bridge.bridge-nf-call-iptables = 1
</span><span style="color:#e6db74">net.ipv6.conf.all.disable_ipv6 = 1
</span><span style="color:#e6db74">net.ipv6.conf.default.disable_ipv6 = 1
</span><span style="color:#e6db74">net.ipv4.ip_forward                 = 1
</span><span style="color:#e6db74">net.bridge.bridge-nf-call-ip6tables = 1
</span><span style="color:#e6db74">EOF</span>

sysctl --system
</code></pre></div><p>Disable swap for Kubernetes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">free -h
swapoff -a
swapoff -a
sed -i.bak -r <span style="color:#e6db74">&#39;s/(.+ swap .+)/#\1/&#39;</span> /etc/fstab
free -h
</code></pre></div><p>The I will add the kubernetes repo and Install the packages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat <span style="color:#e6db74">&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style="color:#e6db74">[kubernetes]
</span><span style="color:#e6db74">name=Kubernetes
</span><span style="color:#e6db74">baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
</span><span style="color:#e6db74">enabled=1
</span><span style="color:#e6db74">gpgcheck=1
</span><span style="color:#e6db74">repo_gpgcheck=1
</span><span style="color:#e6db74">gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span><span style="color:#e6db74">EOF</span>

CRIP_VERSION<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>crio --version | awk <span style="color:#e6db74">&#39;{print $3}&#39;</span><span style="color:#66d9ef">)</span>
yum install kubelet-$CRIP_VERSION kubeadm-$CRIP_VERSION kubectl-$CRIP_VERSION -y
</code></pre></div><p>You nee the same cgroup manager in cri-o and kubeadm. The default for kubeadm is cgroupfs and for cri-o the default is systemd. In this example I configured cri-o for cgroupfs.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nano /etc/crio/crio.conf
<span style="color:#f92672">[</span>crio.runtime<span style="color:#f92672">]</span>
conmon_cgroup <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pod&#34;</span>
cgroup_manager <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cgroupfs&#34;</span>

systemctl restart crio
</code></pre></div><p>If you want to use systemd:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#34;KUBELET_EXTRA_ARGS=--cgroup-driver=systemd&#34;</span> | tee /etc/sysconfig/kubelet
</code></pre></div><p>Start Kubernetes with containerd engine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export IP<span style="color:#f92672">=</span>172.17.13.10

dnf install -y iproute-tc

systemctl enable kubelet.service

<span style="color:#75715e"># for multi interface configuration</span>
echo <span style="color:#e6db74">&#39;KUBELET_EXTRA_ARGS=&#34;--node-ip=&#39;</span>$IP<span style="color:#e6db74">&#39; --cgroup-driver=systemd&#34;&#39;</span> &gt; /etc/sysconfig/kubelet

kubeadm config images pull --cri-socket<span style="color:#f92672">=</span>unix:///var/run/crio/crio.sock --kubernetes-version<span style="color:#f92672">=</span>$CRIP_VERSION
kubeadm init --pod-network-cidr<span style="color:#f92672">=</span>10.244.0.0/16 --apiserver-advertise-address<span style="color:#f92672">=</span>$IP  --kubernetes-version<span style="color:#f92672">=</span>$CRIP_VERSION --cri-socket<span style="color:#f92672">=</span>unix:///var/run/crio/crio.sock
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown <span style="color:#66d9ef">$(</span>id -u<span style="color:#66d9ef">)</span>:<span style="color:#66d9ef">$(</span>id -g<span style="color:#66d9ef">)</span> $HOME/.kube/config

kubectl get no
crictl ps

kubectl taint nodes <span style="color:#66d9ef">$(</span>hostname<span style="color:#66d9ef">)</span> node-role.kubernetes.io/master:NoSchedule-
</code></pre></div><h3 id="inincialize-network">Inincialize network</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
kubectl aplly -f kube-flannel.yml
</code></pre></div><p>OR</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl create -f https://docs.projectcalico.org/manifests/tigera-operator.yaml
wget https://docs.projectcalico.org/manifests/custom-resources.yaml

nano custom-resources.yaml
...
      cidr: 10.244.0.0/16
...

kubectl apply -f custom-resources.yaml
</code></pre></div><hr>
<h3 id="install-kata-container-engine">Install Kata container engine</h3>
<p>If all the Nodes are redy deploy a Daemonset to build Kata containers with firecracker:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl get no

NAME    STATUS   ROLES                  AGE     VERSION
alma8   Ready    control-plane,master   2m31s   v1.22.1
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -f https://raw.githubusercontent.com/kata-containers/kata-containers/b24ee4b11e771108d08eadc37938ac2ecf9a6929/tools/packaging/kata-deploy/kata-rbac/base/kata-rbac.yaml

kubectl apply -f https://raw.githubusercontent.com/kata-containers/kata-containers/b24ee4b11e771108d08eadc37938ac2ecf9a6929/tools/packaging/kata-deploy/kata-deploy/base/kata-deploy.yaml
</code></pre></div><p>Verify the pod:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubens kube-system

$ kubectl get DaemonSet
NAME          DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
kata-deploy   <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">1</span>           &lt;none&gt;                   3m43s
kube-proxy    <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">1</span>           kubernetes.io/os<span style="color:#f92672">=</span>linux   10m

$ kubectl get po kata-deploy-5zwmq
NAME                READY   STATUS    RESTARTS   AGE
kata-deploy-5zwmq   1/1     Running   <span style="color:#ae81ff">0</span>          4m24
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl logs kata-deploy-5zwmq
copying kata artifacts onto host
<span style="color:#75715e">#!/bin/bash</span>
KATA_CONF_FILE<span style="color:#f92672">=</span>/opt/kata/share/defaults/kata-containers/configuration-fc.toml /opt/kata/bin/containerd-shim-kata-v2 <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
<span style="color:#75715e">#!/bin/bash</span>
KATA_CONF_FILE<span style="color:#f92672">=</span>/opt/kata/share/defaults/kata-containers/configuration-qemu.toml /opt/kata/bin/containerd-shim-kata-v2 <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
<span style="color:#75715e">#!/bin/bash</span>
KATA_CONF_FILE<span style="color:#f92672">=</span>/opt/kata/share/defaults/kata-containers/configuration-clh.toml /opt/kata/bin/containerd-shim-kata-v2 <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
Add Kata Containers as a supported runtime <span style="color:#66d9ef">for</span> CRIO:

<span style="color:#75715e"># Path to the Kata Containers runtime binary that uses the fc</span>
<span style="color:#f92672">[</span>crio.runtime.runtimes.kata-fc<span style="color:#f92672">]</span>
	runtime_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/usr/local/bin/containerd-shim-kata-fc-v2&#34;</span>
	runtime_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vm&#34;</span>
	runtime_root <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/run/vc&#34;</span>
	privileged_without_host_devices <span style="color:#f92672">=</span> true

<span style="color:#75715e"># Path to the Kata Containers runtime binary that uses the qemu</span>
<span style="color:#f92672">[</span>crio.runtime.runtimes.kata-qemu<span style="color:#f92672">]</span>
	runtime_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/usr/local/bin/containerd-shim-kata-qemu-v2&#34;</span>
	runtime_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vm&#34;</span>
	runtime_root <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/run/vc&#34;</span>
	privileged_without_host_devices <span style="color:#f92672">=</span> true

<span style="color:#75715e"># Path to the Kata Containers runtime binary that uses the clh</span>
<span style="color:#f92672">[</span>crio.runtime.runtimes.kata-clh<span style="color:#f92672">]</span>
	runtime_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/usr/local/bin/containerd-shim-kata-clh-v2&#34;</span>
	runtime_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vm&#34;</span>
	runtime_root <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/run/vc&#34;</span>
	privileged_without_host_devices <span style="color:#f92672">=</span> true
node/alma8 labeled
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ll /opt/kata/bin/
total <span style="color:#ae81ff">157532</span>
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">4045032</span> Jul <span style="color:#ae81ff">19</span> 06:10 cloud-hypervisor
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">42252997</span> Jul <span style="color:#ae81ff">19</span> 06:12 containerd-shim-kata-v2
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">3290472</span> Jul <span style="color:#ae81ff">19</span> 06:14 firecracker
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">2589888</span> Jul <span style="color:#ae81ff">19</span> 06:14 jailer
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">16686</span> Jul <span style="color:#ae81ff">19</span> 06:12 kata-collect-data.sh
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">37429099</span> Jul <span style="color:#ae81ff">19</span> 06:12 kata-monitor
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">54149384</span> Jul <span style="color:#ae81ff">19</span> 06:12 kata-runtime
-rwxr-xr-x. <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">17521656</span> Jul <span style="color:#ae81ff">19</span> 06:18 qemu-system-x86_64
</code></pre></div><p>Restart containerd to enable the new config:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">systemctl restart containerd
</code></pre></div><hr>
<h3 id="start-deployment">Start Deployment</h3>
<p>First I create a <code>RuntimeClass</code> for kata-fc then start a pod with this <code>RuntimeClass</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubens default

kubectl apply -f - <span style="color:#e6db74">&lt;&lt;EOF
</span><span style="color:#e6db74">apiVersion: node.k8s.io/v1
</span><span style="color:#e6db74">kind: RuntimeClass
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  name: kata-fc
</span><span style="color:#e6db74">handler: kata-fc
</span><span style="color:#e6db74">EOF</span>

cat<span style="color:#e6db74">&lt;&lt;EOF | kubectl apply -f -
</span><span style="color:#e6db74">apiVersion: v1
</span><span style="color:#e6db74">kind: Pod
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  labels:
</span><span style="color:#e6db74">    app: untrusted
</span><span style="color:#e6db74">  name: www-kata-fc
</span><span style="color:#e6db74">spec:
</span><span style="color:#e6db74">  runtimeClassName: kata-fc
</span><span style="color:#e6db74">  containers:
</span><span style="color:#e6db74">  - image: nginx:1.18
</span><span style="color:#e6db74">    name: www
</span><span style="color:#e6db74">    ports:
</span><span style="color:#e6db74">    - containerPort: 80
</span><span style="color:#e6db74">EOF</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -f - <span style="color:#e6db74">&lt;&lt;EOF
</span><span style="color:#e6db74">apiVersion: node.k8s.io/v1
</span><span style="color:#e6db74">kind: RuntimeClass
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  name: kata-qemu
</span><span style="color:#e6db74">handler: kata-qemu
</span><span style="color:#e6db74">EOF</span>

cat<span style="color:#e6db74">&lt;&lt;EOF | kubectl apply -f -
</span><span style="color:#e6db74">apiVersion: v1
</span><span style="color:#e6db74">kind: Pod
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  labels:
</span><span style="color:#e6db74">    app: untrusted
</span><span style="color:#e6db74">  name: www-kata-qemu
</span><span style="color:#e6db74">spec:
</span><span style="color:#e6db74">  runtimeClassName: kata-qemu
</span><span style="color:#e6db74">  containers:
</span><span style="color:#e6db74">  - image: nginx:1.18
</span><span style="color:#e6db74">    name: www
</span><span style="color:#e6db74">    ports:
</span><span style="color:#e6db74">    - containerPort: 80
</span><span style="color:#e6db74">EOF</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -f - <span style="color:#e6db74">&lt;&lt;EOF
</span><span style="color:#e6db74">apiVersion: node.k8s.io/v1
</span><span style="color:#e6db74">kind: RuntimeClass
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  name: kata-clh
</span><span style="color:#e6db74">handler: kata-clh
</span><span style="color:#e6db74">EOF</span>

cat<span style="color:#e6db74">&lt;&lt;EOF | kubectl apply -f -
</span><span style="color:#e6db74">apiVersion: v1
</span><span style="color:#e6db74">kind: Pod
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  labels:
</span><span style="color:#e6db74">    app: untrusted
</span><span style="color:#e6db74">  name: www-kata-clh
</span><span style="color:#e6db74">spec:
</span><span style="color:#e6db74">  runtimeClassName: kata-clh
</span><span style="color:#e6db74">  containers:
</span><span style="color:#e6db74">  - image: nginx:1.18
</span><span style="color:#e6db74">    name: www
</span><span style="color:#e6db74">    ports:
</span><span style="color:#e6db74">    - containerPort: 80
</span><span style="color:#e6db74">EOF</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl get po
NAME            READY   STATUS    RESTARTS   AGE
www-kata-clh    1/1     Running   <span style="color:#ae81ff">0</span>          59s
www-kata-fc     1/1     Running   <span style="color:#ae81ff">0</span>          12s
www-kata-qemu   1/1     Running   <span style="color:#ae81ff">0</span>          69s
</code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="https://devopstales.github.io/tags/kubernetes/" rel="tag">Kubernetes</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="https://devopstales.github.io/tags/kata-container/" rel="tag">kata-container</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="https://devopstales.github.io/tags/firecracker/" rel="tag">Firecracker</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="https://devopstales.github.io/tags/cri-o/" rel="tag">CRI-O</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="https://devopstales.github.io/tags/almalinux/" rel="tag">AlmaLinux</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="https://devopstales.github.io/tags/container-runtimes/" rel="tag">container runtimes</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class=coffee_box>
  <div class=coffee_box_wrapper>
    <h3 class=coffee_box_heading>
      Your support is our everlasting motivation,<br>
      that cup of coffee is what keeps us going!
    </h3>
    <hr>
    <p class=coffee_box_content>As we continue to grow, we would wish to reach and impact more people who visit and take advantage of the guides we have on our blog. This is a big task for us and we are so far extremely grateful for the kind people who have shown amazing support for our work over the time we have been online.
    <p class=coffee_box_content>Thank You for your support as we work to give you the best of guides and articles. Click below to buy us a coffee.
    <div class=coffee_box_img>
      <a href=https://www.buymeacoffee.com/devopstales target=_blank>
        <img src="https://devopstales.github.io/img/design/coffee-logo.png" alt="Coffee Box" >
      </a>
    </div>
  </div>
</div>


<script src="https://utteranc.es/client.js"
        repo="devopstales/devopstales.github.io"
        issue-term="url"
        label="utteranc"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="SEARCH…" value="" name="q" aria-label="SEARCH…">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="https://devopstales.github.io/" />
	</form>
</div>

<div class="widget-recent widget">

    <h4 class="widget__title">Blog Series</h4>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            <li><a href="https://devopstales.github.io/series/container-runtimes" class="text-uppercase">container-runtimes (13)</a>
            </li>
            
            <li><a href="https://devopstales.github.io/series/k3s" class="text-uppercase">k3s (7)</a>
            </li>
            
            <li><a href="https://devopstales.github.io/series/k8s-authentication" class="text-uppercase">k8s-authentication (5)</a>
            </li>
            
            <li><a href="https://devopstales.github.io/series/k8s-gitops" class="text-uppercase">k8s-gitops (6)</a>
            </li>
            
            <li><a href="https://devopstales.github.io/series/k8s-network" class="text-uppercase">k8s-network (19)</a>
            </li>
            
            <li><a href="https://devopstales.github.io/series/k8s-security" class="text-uppercase">k8s-security (43)</a>
            </li>
            
            <li><a href="https://devopstales.github.io/series/kubernetes" class="text-uppercase">kubernetes (21)</a>
            </li>
            
        </ul>
    </div>
</div>


<div class="widget-social widget">
	<h4 class="widget-social__title widget__title">Social</h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Twitter" rel="noopener noreferrer" href="https://twitter.com/_devopstales" target="_blank">
				<svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
				<span>Twitter</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="GitHub" rel="noopener noreferrer" href="https://github.com/devopstales" target="_blank">
				<svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0c-106.1 0-192 85.8-192 191.7 0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2 0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8 0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7 0 0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4 0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5 0 25.6-.2 46.3-.2 52.6 0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg>
				<span>GitHub</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="DockerHub" rel="noopener noreferrer" href="https://hub.docker.com/u/devopstales" target="_blank">
				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M4.82 17.275c-.684 0-1.304-.56-1.304-1.24s.56-1.243 1.305-1.243c.748 0 1.31.56 1.31 1.242s-.622 1.24-1.305 1.24zm16.012-6.763c-.135-.992-.75-1.8-1.56-2.42l-.315-.25-.254.31c-.494.56-.69 1.553-.63 2.295.06.562.24 1.12.554 1.554-.254.13-.568.25-.81.377-.57.187-1.124.25-1.68.25H.097l-.06.37c-.12 1.182.06 2.42.562 3.54l.244.435v.06c1.5 2.483 4.17 3.6 7.078 3.6 5.594 0 10.182-2.42 12.357-7.633 1.425.062 2.864-.31 3.54-1.676l.18-.31-.3-.187c-.81-.494-1.92-.56-2.85-.31l-.018.002zm-8.008-.992h-2.428v2.42h2.43V9.518l-.002.003zm0-3.043h-2.428v2.42h2.43V6.48l-.002-.003zm0-3.104h-2.428v2.42h2.43v-2.42h-.002zm2.97 6.147H13.38v2.42h2.42V9.518l-.007.003zm-8.998 0H4.383v2.42h2.422V9.518l-.01.003zm3.03 0h-2.4v2.42H9.84V9.518l-.015.003zm-6.03 0H1.4v2.42h2.428V9.518l-.03.003zm6.03-3.043h-2.4v2.42H9.84V6.48l-.015-.003zm-3.045 0H4.387v2.42H6.8V6.48l-.016-.003z"/></svg>
				<span>DockerHub</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="ArtifactHub" rel="noopener noreferrer" href="https://artifacthub.io/packages/search?user=devopstales" target="_blank">
				<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M4.82 17.275c-.684 0-1.304-.56-1.304-1.24s.56-1.243 1.305-1.243c.748 0 1.31.56 1.31 1.242s-.622 1.24-1.305 1.24zm16.012-6.763c-.135-.992-.75-1.8-1.56-2.42l-.315-.25-.254.31c-.494.56-.69 1.553-.63 2.295.06.562.24 1.12.554 1.554-.254.13-.568.25-.81.377-.57.187-1.124.25-1.68.25H.097l-.06.37c-.12 1.182.06 2.42.562 3.54l.244.435v.06c1.5 2.483 4.17 3.6 7.078 3.6 5.594 0 10.182-2.42 12.357-7.633 1.425.062 2.864-.31 3.54-1.676l.18-.31-.3-.187c-.81-.494-1.92-.56-2.85-.31l-.018.002zm-8.008-.992h-2.428v2.42h2.43V9.518l-.002.003zm0-3.043h-2.428v2.42h2.43V6.48l-.002-.003zm0-3.104h-2.428v2.42h2.43v-2.42h-.002zm2.97 6.147H13.38v2.42h2.42V9.518l-.007.003zm-8.998 0H4.383v2.42h2.422V9.518l-.01.003zm3.03 0h-2.4v2.42H9.84V9.518l-.015.003zm-6.03 0H1.4v2.42h2.428V9.518l-.03.003zm6.03-3.043h-2.4v2.42H9.84V6.48l-.015-.003zm-3.045 0H4.387v2.42H6.8V6.48l-.016-.003z"/></svg>
				<span>ArtifactHUB</span>
			</a>
		</div>
		
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="helm-charts" rel="noopener noreferrer" href="https://devopstales.github.io/helm-charts/" target="_blank">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M4.82 17.275c-.684 0-1.304-.56-1.304-1.24s.56-1.243 1.305-1.243c.748 0 1.31.56 1.31 1.242s-.622 1.24-1.305 1.24zm16.012-6.763c-.135-.992-.75-1.8-1.56-2.42l-.315-.25-.254.31c-.494.56-.69 1.553-.63 2.295.06.562.24 1.12.554 1.554-.254.13-.568.25-.81.377-.57.187-1.124.25-1.68.25H.097l-.06.37c-.12 1.182.06 2.42.562 3.54l.244.435v.06c1.5 2.483 4.17 3.6 7.078 3.6 5.594 0 10.182-2.42 12.357-7.633 1.425.062 2.864-.31 3.54-1.676l.18-.31-.3-.187c-.81-.494-1.92-.56-2.85-.31l-.018.002zm-8.008-.992h-2.428v2.42h2.43V9.518l-.002.003zm0-3.043h-2.428v2.42h2.43V6.48l-.002-.003zm0-3.104h-2.428v2.42h2.43v-2.42h-.002zm2.97 6.147H13.38v2.42h2.42V9.518l-.007.003zm-8.998 0H4.383v2.42h2.422V9.518l-.01.003zm3.03 0h-2.4v2.42H9.84V9.518l-.015.003zm-6.03 0H1.4v2.42h2.428V9.518l-.03.003zm6.03-3.043h-2.4v2.42H9.84V6.48l-.015-.003zm-3.045 0H4.387v2.42H6.8V6.48l-.016-.003z"/></svg>
				<span>helm-charts</span>
			</a>
		</div>
		
	</div>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/k8s-ps/">Kubernetes Pod Security</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/azure-dc-deploy/">How to deploy a Domain Controller on Microsoft Azure</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/pfsense-ad-join/">Firewall Ports for AD Domain Join</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/k8s-install-containerd/">Install kubernetes with kubeadm</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/k8s-central-oauth/">Central authentication with oauth2-proxy</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/k8s-rbac-gen/">How to create kubeconfig?</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/k8s-falco/">Kubernetes audit logs and Falco</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/k8s-cisa-install/">Kubernetes Hardening Guide with CISA 1.6 Benchmark</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/cilium-clustermesh/">Kubernetes Multicluster with Cilium Cluster Mesh</a></li>
			<li class="widget__item"><a class="widget__link" href="https://devopstales.github.io/home/docker-desktop-alternatives/">Free Docker Desktop Alternative For Mac And Windows</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/2fa/" title="2FA">2FA</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/active-directory/" title="active-directory">active-directory</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/admission-controller/" title="Admission Controller">Admission Controller</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/aks/" title="AKS">AKS</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/alerta/" title="alerta">alerta</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/almalinux/" title="AlmaLinux">AlmaLinux</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ansible/" title="Ansible">Ansible</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ansible-tower/" title="Ansible Tower">Ansible Tower</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/awx/" title="AWX">AWX</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/azure/" title="Azure">Azure</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/backup/" title="Backup">Backup</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/bgp/" title="BGP">BGP</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/calico/" title="Calico">Calico</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/centos/" title="Centos">Centos</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/centreon/" title="centreon">centreon</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ceph/" title="Ceph">Ceph</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/chef/" title="Chef">Chef</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/cilium/" title="Cilium">Cilium</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/cluster/" title="cluster">cluster</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/container-runtimes/" title="Container runtimes">Container runtimes</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/containerd/" title="Containerd">Containerd</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/coredns/" title="CoreDNS">CoreDNS</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/cosign/" title="Cosign">Cosign</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/cri-o/" title="CRI-O">CRI-O</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/debian/" title="Debian">Debian</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/dns/" title="DNS">DNS</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/docker/" title="docker">docker</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/docker-compose/" title="docker-compose">docker-compose</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ebpf/" title="ebpf">ebpf</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/elasticsearch/" title="elasticsearch">elasticsearch</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/falco/" title="falco">falco</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/fedora/" title="fedora">fedora</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/fedora-coreos/" title="Fedora CoreOS">Fedora CoreOS</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/firecracker/" title="Firecracker">Firecracker</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/flannel/" title="Flannel">Flannel</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/foreman/" title="foreman">foreman</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/gcp/" title="GCP">GCP</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/gitlab/" title="Gitlab">Gitlab</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/gitops/" title="gitops">gitops</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/gke/" title="GKE">GKE</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/gns3/" title="GNS3">GNS3</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/google-cloud-platform/" title="Google Cloud Platform">Google Cloud Platform</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/grafana/" title="grafana">grafana</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/graylog/" title="Graylog">Graylog</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/gvisor/" title="gvisor">gvisor</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ha/" title="HA">HA</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/harbor/" title="Harbor">Harbor</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/hashicorp-vault/" title="HashiCorp Vault">HashiCorp Vault</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/helm-controller/" title="helm-controller">helm-controller</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/helm2/" title="helm2">helm2</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/helm3/" title="helm3">helm3</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/hp/" title="HP">HP</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/httpd/" title="httpd">httpd</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/icinga/" title="icinga">icinga</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ilo/" title="ILO">ILO</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/influxdb/" title="Influxdb">Influxdb</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ipmitool/" title="ipmitool">ipmitool</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/jitsi/" title="jitsi">jitsi</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/k0s/" title="K0S">K0S</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/k3s/" title="K3S">K3S</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/k8s/" title="K8S">K8S</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/kafka/" title="Kafka">Kafka</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/kata-container/" title="kata-container">kata-container</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/katello/" title="katello">katello</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/keycloak/" title="Keycloak">Keycloak</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/kube-proxy/" title="kube-proxy">kube-proxy</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/kubernetes/" title="Kubernetes">Kubernetes</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/kyverno/" title="Kyverno">Kyverno</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/logging/" title="logging">logging</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/loki/" title="loki">loki</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/mattermost/" title="Mattermost">Mattermost</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/metallb/" title="MetalLB">MetalLB</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/mutating-webhook/" title="mutating webhook">mutating webhook</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/mysql/" title="mysql">mysql</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/naemon/" title="Naemon">Naemon</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/nagios/" title="Nagios">Nagios</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/nerdctl/" title="nerdctl">nerdctl</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/nextcloud/" title="nextcloud">nextcloud</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/nexus-oss/" title="Nexus OSS">Nexus OSS</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/nosql/" title="noSQL">noSQL</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/notary/" title="Notary">Notary</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/oauth2/" title="oauth2">oauth2</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/oidc/" title="oidc">oidc</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/openproject/" title="openproject">openproject</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/openshift/" title="Openshift">Openshift</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/openshift-3.11/" title="Openshift 3.11">Openshift 3.11</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/openshift-4/" title="Openshift 4">Openshift 4</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/openvpn/" title="OpenVPN">OpenVPN</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/operator/" title="Operator">Operator</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/opnsense/" title="OPNsense">OPNsense</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/pfsense/" title="Pfsense">Pfsense</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/postgresql/" title="postgresql">postgresql</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/powershell/" title="PowerShell">PowerShell</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/privacyidea/" title="privacyidea">privacyidea</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/prometheus/" title="Prometheus">Prometheus</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/proxmox/" title="Proxmox">Proxmox</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/pxe/" title="PXE">PXE</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/rancher/" title="rancher">rancher</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/rbac/" title="RBAC">RBAC</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/redmine/" title="redmine">redmine</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/registry/" title="registry">registry</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/rke2/" title="rke2">rke2</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/rsyslog/" title="rsyslog">rsyslog</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/rundeck/" title="rundeck">rundeck</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/s3/" title="S3">S3</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/secuity/" title="Secuity">Secuity</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/sonarqube/" title="sonarqube">sonarqube</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/spacewalk/" title="Spacewalk">Spacewalk</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/squid/" title="squid">squid</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/supermicro/" title="Supermicro">Supermicro</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/telegraf/" title="telegraf">telegraf</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/ubuntu/" title="Ubuntu">Ubuntu</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/unifi/" title="Unifi">Unifi</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/vagrant/" title="Vagrant">Vagrant</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/vmware/" title="vmware">vmware</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/wildfly/" title="Wildfly">Wildfly</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/windows/" title="windows">windows</a>
		<a class="widget-taglist__link widget__link btn" href="https://devopstales.github.io/tags/zfs/" title="ZFS">ZFS</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
        <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
             data-id="devopstales" data-description="Support me on Buy me a coffee!"
             data-message="Thank you for visiting. You can now buy me a coffee!"
             data-color="#FF813F" data-position="right" data-x_margin="18" data-y_margin="48">
        </script>
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 devopstales.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

	</div>
<script async defer src="https://devopstales.github.io/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
<div class="cookie-container" style="justify-content: space-between;">
  <div class="cookie-consent-text">
    This website makes use of third-party cookies.
     <a href="https://devopstales.github.io/privacy-policy/">Learn More</a>
  </div>
  <div class="cookie-consent-button">
    <button class="cookie-btn">
      Okay
    </button>
  </div>
</div>
<script src="https://devopstales.github.io/js/cookie.js"></script>


<script src="https://devopstales.github.io/js/medium-zoom.js"></script>
<script>

var zoomables = document.querySelectorAll('.zoomable > img, img.zoomable');
zoomables.length && mediumZoom(zoomables, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null,  
    background: 'rgba(0, 0, 0, 0.8)'
  }
);
</script></body>
</html>
